from pwn import remote
from hashlib import sha256
import time

host = "94.237.52.107"
port = 43589

r = 9239170502198261360768892519994128238902042124694956396770270450817
s = 9160602924526616029702549432340782373685601810830055852562161526328

p = 18074887271995451789513384455834055689722585372023430948546172747028198249188308580348364246490503646561497958920232960411221289888981859496240852990676966919812467392557368668427066752396088891308692280946264630642278842424669502031161776330536169711333807211437057061686585317265379273672980759394844634989179812477746650918648346037645068671688817406940915111234710585072426020697991563135030251794013202451826763318664074178186046201373847563874864675313893653578574347597769891491746358438736500774491101926136277048846983523811780786518478731129891122881976605733528501778959483052518321653461945409105493481491
q = 17945200639255429777929346928635105305642016564645458593459448469579
g = 7523686191327816531018943671722153544116430590493021004335027339838035355333210731124915739376940893132748413352415788159755767431393494551011410284674193166663503583514565104919093820543423701626181511250589232636858538308516456865377901632290835929806721788532122769327552821356122826763931455374540492588706336776188843660758106938372935172128307406248804132528067098509890209722860797265712633677407092441590557010388610358565353533926764640784595403857733928028964102686054465939297508992538969608389653595643253580323603781648475850656053197081834281819812080185985832364721286348256166529349463733850593846886

message = "Testing signing feature"
h = int(sha256(message.encode()).hexdigest(), 16)

for k in range(65500, 70000):  
    r_test = pow(g, k, p) % q
    if r_test != r:
        continue 

    try:
        k_inv = pow(k, -1, q)
        x_candidate = (s * k - h) * pow(r, -1, q) % q

        with remote(host, port) as conn:
            conn.sendline(f"{x_candidate}")  
            response = conn.recvline(timeout=2) 
            print(f"Attempt with k={k} returned: {response}")

            if b"success" in response.lower():
                print(f"[+] Private key found: x = {x_candidate} with k = {k}")
                break  # Stop once private key is found
            
        time.sleep(0.1)  
    except ValueError:
        continue  
    except Exception as e:
        print(f"[!] Error encountered: {e}")
        continue
